@using OrderDeliverySystem.Client.Shared
@using OrderDeliverySystem.Client.Pages.Customer
@using OrderDeliverySystem.Components
@using System.ComponentModel.DataAnnotations
@inject IHttpClientFactory HttpClientFactory
@inject IJSRuntime JSRuntime
@inject NavigationManager NavigationManager
@rendermode InteractiveServer


@if (Role == "Customer" || Role == "Guest")
{
    <MudLink Href="/"><MudImage Src="images/logo.png" Width="120" Height="80" Alt="Swedish Farm House" Href="/" Class="rounded-lg m-4" /></MudLink>

    <MudSpacer />
    <MudButtonGroup Color="Color.Dark" Variant="Variant.Text">
        <MudButton Href="/restaurants">Restaurants</MudButton>
        <MudButton Href="/about-us">About Us</MudButton>
        <MudButton Href="/contact">Contact</MudButton>
        @if (isUser)
        {
            <MudButton Href="/my-orders">My Orders</MudButton>
        }
        else
        {
            <MudButton Href="/register">Sign Up</MudButton>
        }

    </MudButtonGroup>
    <MudSpacer />
   
    @if (isUser)
    {



        <MudIconButton OnClick="OnExpandCartClick" Icon="@Icons.Material.Filled.AddShoppingCart" Style="color: rgba(168, 0, 0, 1);">@(_cartExpanded ?"" : "")</MudIconButton>
        <MudIconButton Href="/customer-profile" Icon="@Icons.Material.Filled.PersonOutline" Style="color: rgba(168, 0, 0, 1);" />

        <MudFab Style="color: rgba(168, 0, 0, 1);" Label="Log Out" OnClick="LogOut" />
       
    }
    else
    {
        <MudFab StartIcon="@Icons.Material.Filled.PersonOutline" Style="color: rgba(168, 0, 0, 1);" Label="Login" OnClick="LogIn" />
    }

}
else
{
    <MudButton Href="/"><MudImage Src="images/logo.png" Width="120" Height="80" Alt="Swedish Farm House" Href="/dashboard" Class="rounded-lg m-4" /></MudButton>

    <MudSpacer />
    @if (isUser)
    {
        <MudFab StartIcon="@Icons.Material.Filled.PersonOutline" Style="color: rgba(168, 0, 0, 1);" Label="Log Out" OnClick="LogOut" />

    }
    else
    {
        <MudFab StartIcon="@Icons.Material.Filled.PersonOutline" Style="color: rgba(168, 0, 0, 1);" Label="Login" Href="/login" />

    }
    
}


    <MudCollapse Expanded="_cartExpanded" >
        @if (_cartExpanded)
        {
            <Cart/>
        }
    </MudCollapse>




@code{
    [Parameter] public string Role { get; set; }
    bool isUser = false;
    protected override async Task OnInitializedAsync()
    {
        if (!Role.Equals("Guest")|| !Role.Equals(String.Empty))
        {
            isUser = true;
        }
    }

 
    bool isCustomer = true;
    bool _cartExpanded = false;


    private void OnExpandCartClick()
    {
        _cartExpanded = !_cartExpanded;
    }
    public async Task LogOut()
    {
        Console.WriteLine(isUser); 
        isUser = false;
        isCustomer = true;
        StateHasChanged();
        NavigationManager.NavigateTo("/");
    }
    public async Task LogIn()
    {
        NavigationManager.NavigateTo("/login");
    }

   

    
}